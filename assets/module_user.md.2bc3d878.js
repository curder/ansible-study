import{_ as s,c as o,o as a,O as e}from"./chunks/framework.e51d172d.js";const A=JSON.parse('{"title":"user 模块","description":"","frontmatter":{},"headers":[],"relativePath":"module/user.md","lastUpdated":1679033122000}'),l={name:"module/user.md"},n=e(`<h1 id="user-模块" tabindex="-1">user 模块 <a class="header-anchor" href="#user-模块" aria-label="Permalink to &quot;user 模块&quot;">​</a></h1><p><a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/user_module.html" target="_blank" rel="noreferrer">user 模块</a>管理用户帐户。</p><h2 id="常用参数" tabindex="-1">常用参数 <a class="header-anchor" href="#常用参数" aria-label="Permalink to &quot;常用参数&quot;">​</a></h2><table><thead><tr><th>参数名</th><th>参数类型</th><th>是否必填</th><th>可选值</th><th>说明</th></tr></thead><tbody><tr><td><code>name</code></td><td><code>string</code></td><td>是</td><td><em>e.g.</em><code>ubuntu</code></td><td>创建用户的名称</td></tr><tr><td><code>create_home</code></td><td><code>boolean</code></td><td>否</td><td><strong><code>true</code></strong><br><code>false</code></td><td><small>是否为用户创建一个家目录</small></td></tr><tr><td><code>group</code></td><td><code>string</code></td><td>否</td><td><em>e.g.</em><code>depops</code></td><td>创建用户组</td></tr><tr><td><code>password</code></td><td><code>string</code></td><td></td><td>—</td><td>创建用户的密码</td></tr><tr><td><code>uid</code></td><td><code>integer</code></td><td>否</td><td><em>e.g.</em><code>1234</code></td><td>创建用户的UID</td></tr><tr><td><code>shell</code></td><td><code>string</code></td><td>否</td><td><em>e.g.</em><code>/sbin/nologin</code></td><td>用户登录的解释器</td></tr><tr><td><code>state</code></td><td><code>string</code></td><td>否</td><td><code>absent</code><br><strong><code>present</code></strong></td><td>该帐户是否应该存在</td></tr><tr><td><code>expires</code></td><td><code>float</code></td><td>否</td><td>—</td><td>账户过期时间</td></tr></tbody></table><p>更多参数可以使用命令 <code>ansible-doc -s user</code> 获取更多使用相关的文档或者<a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/user_module.html#parameters" target="_blank" rel="noreferrer">查看官方文档</a>。</p><h2 id="一些示例" tabindex="-1">一些示例 <a class="header-anchor" href="#一些示例" aria-label="Permalink to &quot;一些示例&quot;">​</a></h2><h3 id="创建用户并指定uid" tabindex="-1">创建用户并指定uid <a class="header-anchor" href="#创建用户并指定uid" aria-label="Permalink to &quot;创建用户并指定uid&quot;">​</a></h3><p>创建一个 <code>devops</code> 用户且设置 <code>uid</code> 为 <code>1234</code>。</p><p>使用到 user 模块的 <code>name</code> 和 <code>uid</code> 参数。</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">ansible</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">all</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">src/inventory.yml</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">user</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name=devops uid=1234</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 查看用户和uid</span></span>
<span class="line"><span style="color:#FFCB6B;">ansible</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">all</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">src/inveotory.yml</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">shell</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">id devops</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><h3 id="创建用户并不允许登录" tabindex="-1">创建用户并不允许登录 <a class="header-anchor" href="#创建用户并不允许登录" aria-label="Permalink to &quot;创建用户并不允许登录&quot;">​</a></h3><p>创建一个 <code>deployer</code> 用户，设置 <code>uid</code> 和 <code>gid</code> 均为 <code>8888</code>，同时不创建家目录且不允许登录。</p><ul><li><p>使用 <strong>group</strong> 模块创建 <code>deployer</code> 用户组并指定组id为 <code>8888</code>；使用到 <code>name</code> 和 <code>gid</code> 参数。</p></li><li><p>使用 <strong>user</strong> 模块创建 <code>deployer</code> 用户，指定用户组为 <code>deployer</code>，指定uid为 <code>8888</code>，不创建用户家目录且不允许登录；使用到 <code>name</code>、<code>group</code>、<code>uid</code>、<code>create_home</code> 和 <code>shell</code> 参数。</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">ansible</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">all</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">src/inventory.yml</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">group</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name=deployer gid=8888</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#FFCB6B;">ansible</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">all</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">src/inventory.yml</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">user</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name=deployer group=deployer uid=8888 create_home=false shell=/sbin/nologin</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 查看用户和用户组信息</span></span>
<span class="line"><span style="color:#FFCB6B;">ansible</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">all</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">src/inventory.yml</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">shell</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">id deployer</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#FFCB6B;">ansible</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">all</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">src/inventory.yml</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">shell</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">grep deployer /etc/passwd</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#FFCB6B;">ansible</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">all</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">src/inventory.yml</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">shell</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ls -ld /home/deployer</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div></li></ul><h3 id="删除用户" tabindex="-1">删除用户 <a class="header-anchor" href="#删除用户" aria-label="Permalink to &quot;删除用户&quot;">​</a></h3><p>user 模块删除用户使用 <code>name</code>、<code>state</code> 和 <code>remove</code> 参数。</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">ansible</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">all</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">src/inventory.yml</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">user</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name=devops</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">ansible</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">all</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">src/inventory.yml</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">user</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name=devops state=absent remove=true</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><p>更多 user 模块的示例可以<a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/user_module.html#examples" target="_blank" rel="noreferrer">查看官方文档</a>。</p>`,17),t=[n];function p(c,r,d,C,y,D){return a(),o("div",null,t)}const u=s(l,[["render",p]]);export{A as __pageData,u as default};
