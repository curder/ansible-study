import{_ as s,c as a,o as n,a as l}from"./app.12388799.js";const A=JSON.parse('{"title":"认证方式","description":"","frontmatter":{},"headers":[{"level":2,"title":"密码认证","slug":"密码认证","link":"#密码认证","children":[]},{"level":2,"title":"密钥对认证","slug":"密钥对认证","link":"#密钥对认证","children":[]}],"relativePath":"guide/verification-method.md","lastUpdated":1677246344000}'),p={name:"guide/verification-method.md"},o=l(`<h1 id="认证方式" tabindex="-1">认证方式 <a class="header-anchor" href="#认证方式" aria-hidden="true">#</a></h1><p>安全认证分为两种：</p><ul><li>第一种是：密码认证，但是密码是明文配置在主机清单配置文件中，考虑到安全性问题，不推荐使用。</li><li>第二种是：SSH Key 秘钥对验证，安全性相对明文来说较高，推荐使用。</li></ul><h2 id="密码认证" tabindex="-1">密码认证 <a class="header-anchor" href="#密码认证" aria-hidden="true">#</a></h2><table><thead><tr><th>参数</th><th>参数类型</th><th>参数说明</th></tr></thead><tbody><tr><td><code>ansible_host</code></td><td>主机地址</td><td>被管理服务器的IP地址</td></tr><tr><td><code>ansible_port</code></td><td>主机端口</td><td>被管理服务器开放的SSH端口</td></tr><tr><td><code>ansible_user</code></td><td>主机用户</td><td>被管理服务器SSH用户</td></tr><tr><td><code>ansible_password</code></td><td>主机密码</td><td>被管理服务器SSH用户对应的密码</td></tr></tbody></table><p>更多 ansible 连接参数参考<a href="https://docs.ansible.com/ansible/latest/inventory_guide/intro_inventory.html#connecting-to-hosts-behavioral-inventory-parameters" target="_blank" rel="noreferrer">官方地址</a>。</p><p>比如在主机清单中中添加以上配置：</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-a9Zwz" id="tab-_l3Qla2" checked="checked"><label for="tab-_l3Qla2">ini</label><input type="radio" name="group-a9Zwz" id="tab-Ck5pJQq"><label for="tab-Ck5pJQq">yaml</label></div><div class="blocks"><div class="language-ini active"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">[web]</span></span>
<span class="line"><span style="color:#A6ACCD;">centos </span><span style="color:#F07178;">ansible_host</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">10.211.55.4 </span><span style="color:#F07178;">ansible_user</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">root </span><span style="color:#F07178;">ansible_password</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">a </span><span style="color:#F07178;">ansible_port</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">22</span></span>
<span class="line"><span style="color:#A6ACCD;">ubuntu </span><span style="color:#F07178;">ansible_host</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">10.211.55.5 </span><span style="color:#F07178;">ansible_user</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">root </span><span style="color:#F07178;">ansible_password</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">a </span><span style="color:#F07178;">ansible_port</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">22</span></span>
<span class="line"></span></code></pre></div><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#F07178;">web</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">hosts</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">centos</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">ansible_host</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10.211.55.4</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">ansible_user</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">root</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">ansible_password</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">a</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">ansible_port</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">22</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">ubuntu</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#F07178;">ansible_host</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10.211.55.5</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#F07178;">ansible_user</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">root</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#F07178;">ansible_password</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">a</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#F07178;">ansible_port</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">22</span></span>
<span class="line"></span></code></pre></div></div></div><p>使用 ansible 临时命令模式执行测试：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">ansible</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">web</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">inventory.ini</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hostname</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#FFCB6B;">ansible</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">web</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">inventory.yml</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hostname</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><details class="details custom-block"><summary>sshpass错误处理</summary><p>如果在执行上面的命令时，抛出 <code>to use the &#39;ssh&#39; connection type with passwords or pkcs11_provider, you must install the sshpass program</code> 的错误。</p><p>针对不同的操作系统，有不同的解决方案：</p><ul><li><p><strong>MacOS</strong></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">brew</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://raw.githubusercontent.com/kadwanev/bigboybrew/master/Library/Formula/sshpass.rb</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 如果通过上面的方式无法一条命令完成安装，可以使用下面的方式通过源代码方式安装</span></span>
<span class="line"><span style="color:#FFCB6B;">wget</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://sourceforge.net/projects/sshpass/files/latest/download/sshpass/</span><span style="color:#F78C6C;">1.10</span><span style="color:#C3E88D;">/sshpass-1.10.tar.gz</span></span>
<span class="line"><span style="color:#FFCB6B;">tar</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">xvf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">sshpass-1.10.tar.gz</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">sshpass-</span><span style="color:#F78C6C;">1.10</span></span>
<span class="line"><span style="color:#82AAFF;">.</span><span style="color:#FFCB6B;">/configure</span></span>
<span class="line"><span style="color:#FFCB6B;">make</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">make</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span></span>
<span class="line"></span></code></pre></div></li><li><p><strong>CentOS</strong></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">sshpass</span></span>
<span class="line"></span></code></pre></div></li><li><p><strong>Ubuntu</strong></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">apt</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">sshpass</span></span>
<span class="line"></span></code></pre></div></li></ul></details><h2 id="密钥对认证" tabindex="-1">密钥对认证 <a class="header-anchor" href="#密钥对认证" aria-hidden="true">#</a></h2>`,12),e=[o];function t(c,r,i,y,C,d){return n(),a("div",null,e)}const F=s(p,[["render",t]]);export{A as __pageData,F as default};
